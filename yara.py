import requests
import json

def query_yaraify(diff_hash):
    hash_type = None
    if len(diff_hash) == 32:
        hash_type = "MD5"
    elif len(diff_hash) == 40:
        hash_type = "SHA1"
    elif len(diff_hash) == 64:
        hash_type = "SHA256"
    elif len(diff_hash) == 96:
        hash_type = "SHA3-384"
    else:
        raise ValueError("Invalid hash: must be MD5, SHA1, SHA256, or SHA3-384")

    url = "https://yaraify-api.abuse.ch/api/v1/"
    payload = {
        "query": "lookup_hash",
        "search_term": diff_hash,
    }

    response = requests.post(url, json=payload)

    if response.status_code == 200:
        json_response = response.json()
        formatted_json = json.dumps(json_response, indent=4)
        print(formatted_json)
    else:
        response.raise_for_status()

if __name__ == '__main__':
    diff_hash = input("Enter the hash of the file to download: ")
    query_yaraify(diff_hash)
